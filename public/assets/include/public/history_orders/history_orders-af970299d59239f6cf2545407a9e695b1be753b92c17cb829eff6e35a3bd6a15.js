var history_orders={id_order:null,initOnLoad:function(){history_orders.event_tab_notdefined(),$(".nav-tabs a").on("shown.bs.tab",function(e){var t=$(e.target).attr("href");"#order_notdefined"===t&&history_orders.event_tab_notdefined(),"#order_defined"===t&&history_orders.event_tab_defined(),"#order_cancel"===t&&history_orders.event_tab_cancel()}),history_orders.show_modal(),history_orders.export_file()},event_tab_notdefined:function(){var e="",t=$("#data-notdefined-order").html();data=history_orders.request_order(1),t&&$.each(data,function(r,o){e+=Mustache.render(t,{ID:o.id,KNAME:o.user.name,PHONENUMBER:o.phone,ADDRESS:o.address,EMAIL:o.user.email,PRICE:formatPrice(o.total_price.toString())+" \u0111",DATETIME:history_orders.formatDateTime(o.created_at)})}),$(".load-notdefined-order").html(e)},event_tab_defined:function(){var e="",t=$("#data-defined-order").html();data=history_orders.request_order(2),t&&$.each(data,function(r,o){e+=Mustache.render(t,{ID:o.id,KNAME:o.user.name,PHONENUMBER:o.phone,ADDRESS:o.address,EMAIL:o.user.email,PRICE:formatPrice(o.total_price.toString())+" \u0111",DATETIME:history_orders.formatDateTime(o.created_at)})}),$(".load-defined-order").html(e)},event_tab_cancel:function(){var e="",t=$("#data-cancel-order").html();data=history_orders.request_order(3),t&&$.each(data,function(r,o){e+=Mustache.render(t,{ID:o.id,KNAME:o.user.name,PHONENUMBER:o.phone,ADDRESS:o.address,EMAIL:o.user.email,PRICE:formatPrice(o.total_price.toString())+" \u0111",DATETIME:history_orders.formatDateTime(o.created_at)})}),$(".load-cancel-order").html(e)},request_order:function(e){return data=null,$.ajax({url:"/request_history_order/"+e,type:"GET",contentType:"application/json; charset=utf-8",dataType:"JSON",async:!1,success:function(e){data=e},error:function(e){console.log(e)}}),data},show_modal:function(){$(document).on("click","tr.show_modal",function(){var e=$(this).attr("data-order-id");$("#detailsModal").modal(),history_orders.ajaxShowDetails(e),history_orders.id_order=e})},ajaxShowDetails:function(e){$.ajax({url:"/admin/orders/"+e,type:"GET",contentType:"application/json; charset=utf-8",dataType:"JSON",success:function(e){var t="",r=$("#data-template-modal-line-item").html(),o=0,a="/assets/no-product-image-0f35e2b34a82f17cac95766bab3727091fc29403eeb8c3241290ba8a086b600d.png";$.each(e,function(e,n){images=n.product.images.length,images=images>0?n.product.images[0].url:a,t+=Mustache.render(r,{IMAGE:images,NAME:n.product.name,PRICE:formatPrice(n.amount)+" \u0111"}),o+=n.amount}),$("tbody#viewLoadLineItem").html(t),$("strong#totalPri").html("T\u1ed5ng ti\u1ec1n: "+formatPrice(o)+" \u0111")},error:function(e){console.log(e)}})},export_file:function(e){$("#btn-export").on("click",function(){e=history_orders.id_order,window.location="/history_orders/"+e+"/export_file.xlsx"})},formatDateTime:function(e){var t=new Date(e);return dateTime=moment(t).format("DD-MM-YYYY HH:mm:ss"),dateTime}};$(document).ready(function(){history_orders.initOnLoad()});